<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Unity-multiplayer by co2meal</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/co2meal/unity-multiplayer">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/co2meal/unity-multiplayer/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/co2meal/unity-multiplayer/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Unity-multiplayer</h1>
          <p></p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/co2meal">co2meal</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h3>
<a id="unity---multiplayer" class="anchor" href="#unity---multiplayer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Unity - Multiplayer</h3>

<p>Unity와 Socket.io 이용해서 Multiplayer를 구현하는 방법에 대해 소개하려고 함.
대략 이정도 수준의 결과물이 나올 예정.</p>



<h3>
<a id="먼저-설치해야-할-것-버전은-달라도-잘-될-가능성-높음" class="anchor" href="#%EB%A8%BC%EC%A0%80-%EC%84%A4%EC%B9%98%ED%95%B4%EC%95%BC-%ED%95%A0-%EA%B2%83-%EB%B2%84%EC%A0%84%EC%9D%80-%EB%8B%AC%EB%9D%BC%EB%8F%84-%EC%9E%98-%EB%90%A0-%EA%B0%80%EB%8A%A5%EC%84%B1-%EB%86%92%EC%9D%8C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>먼저 설치해야 할 것. (버전은 달라도 잘 될 가능성 높음.)</h3>

<p>Unity 5, Node.js v6.5.0, Atom Editor v1.10.2</p>

<h3>
<a id="서버의-역할" class="anchor" href="#%EC%84%9C%EB%B2%84%EC%9D%98-%EC%97%AD%ED%95%A0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>서버의 역할</h3>

<ul>
<li>서버는 모든 플레이어의 위치를 기억해 두기</li>
<li>접속하고 있는 모든 클라이언트들에게 모든 플레이어들의 위치를 알려주기</li>
</ul>

<h3>
<a id="클라이언트의-역할" class="anchor" href="#%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98-%EC%97%AD%ED%95%A0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>클라이언트의 역할</h3>

<ul>
<li>메인 플레이어의 위치를 서버에게 알려주기</li>
<li>메인 플레이어 조작하기</li>
<li>서버가 다른 플레이어의 위치를 알려주면 업데이트 하기.</li>
</ul>

<h3>
<a id="1-스타팅-포인트-다운받기" class="anchor" href="#1-%EC%8A%A4%ED%83%80%ED%8C%85-%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EB%8B%A4%EC%9A%B4%EB%B0%9B%EA%B8%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 스타팅 포인트 다운받기</h3>

<p>먼저 공굴리기 유니티 프로젝트 준비하기.<br>
공에 콘트롤러 붙여서 맵을 돌아다니기만 하는게 끝임.<br>
그냥 다운받아도 되고 직접 따라가면서 해봐도 됨.</p>

<p><a href="https://github.com/co2meal/unity-multiplayer/raw/master/Unity-Multiplayer-Starting-Point.zip">그냥 다운받기 (권장)</a><br>
<a href="https://unity3d.com/kr/learn/tutorials/projects/roll-ball-tutorial/setting-play-area?playlist=17141">직접 따라가기</a>
(2-2 Setting up the play area 까지.)</p>

<p>다운받았으면, 압축을 풀고 Unity에서 불러옴.</p>

<p><img src="https://github.com/co2meal/unity-multiplayer/raw/master/%EC%8A%A4%ED%83%80%ED%8C%85%20%ED%8F%AC%EC%9D%B8%ED%8A%B8%20%EC%82%AC%EC%A7%84%201.PNG" alt=""></p>

<h3>
<a id="2-socketio-설치-및-서버-프로그래밍" class="anchor" href="#2-socketio-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%84%9C%EB%B2%84-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. Socket.io 설치 및 서버 프로그래밍</h3>

<h4>
<a id="1-project-폴더에-새폴더를-만들고-server라고-이름을-지음" class="anchor" href="#1-project-%ED%8F%B4%EB%8D%94%EC%97%90-%EC%83%88%ED%8F%B4%EB%8D%94%EB%A5%BC-%EB%A7%8C%EB%93%A4%EA%B3%A0-server%EB%9D%BC%EA%B3%A0-%EC%9D%B4%EB%A6%84%EC%9D%84-%EC%A7%80%EC%9D%8C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. Project 폴더에 새폴더를 만들고 Server라고 이름을 지음</h4>

<p><img src="https://github.com/co2meal/unity-multiplayer/raw/master/2.1%20-%20Socket%20IO%20%EC%BD%94%EB%93%9C%EC%9A%A9%20%ED%8F%B4%EB%8D%94%20%EB%A7%8C%EB%93%A4%EA%B8%B0.PNG" alt=""></p>

<h4>
<a id="2-server폴더에-shift---우클릭으로-여기서-명령-창-열기-누름" class="anchor" href="#2-server%ED%8F%B4%EB%8D%94%EC%97%90-shift---%EC%9A%B0%ED%81%B4%EB%A6%AD%EC%9C%BC%EB%A1%9C-%EC%97%AC%EA%B8%B0%EC%84%9C-%EB%AA%85%EB%A0%B9-%EC%B0%BD-%EC%97%B4%EA%B8%B0-%EB%88%84%EB%A6%84" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. Server폴더에 Shift - 우클릭으로 "여기서 명령 창 열기" 누름.</h4>

<p><img src="https://github.com/co2meal/unity-multiplayer/raw/master/2.2%20-%20%EC%97%AC%EA%B8%B0%EC%84%9C%20%EB%AA%85%EB%A0%B9%20%EC%B0%BD%20%EC%97%B4%EA%B8%B0.PNG" alt=""></p>

<h4>
<a id="3-npm-install-socketio로-socketio-패키지-설치-아래와-같이-결과가-나오면-성공한-것임" class="anchor" href="#3-npm-install-socketio%EB%A1%9C-socketio-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98-%EC%95%84%EB%9E%98%EC%99%80-%EA%B0%99%EC%9D%B4-%EA%B2%B0%EA%B3%BC%EA%B0%80-%EB%82%98%EC%98%A4%EB%A9%B4-%EC%84%B1%EA%B3%B5%ED%95%9C-%EA%B2%83%EC%9E%84" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. <code>npm install socket.io</code>로 <code>socket.io</code> 패키지 설치. 아래와 같이 결과가 나오면 성공한 것임.</h4>

<pre><code>E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer\Server&gt;npm install socket.io
E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer\Server
`-- socket.io@1.4.8
  +-- debug@2.2.0
  | `-- ms@0.7.1
  +-- engine.io@1.6.11
  | +-- accepts@1.1.4
  | | +-- mime-types@2.0.14
  | | | `-- mime-db@1.12.0
  | | `-- negotiator@0.4.9
  | +-- base64id@0.1.0
  | +-- engine.io-parser@1.2.4
  | | +-- after@0.8.1
  | | +-- arraybuffer.slice@0.0.6
  | | +-- base64-arraybuffer@0.1.2
  | | +-- blob@0.0.4
  | | +-- has-binary@0.1.6
  | | `-- utf8@2.1.0
  | `-- ws@1.1.0
  |   +-- options@0.0.6
  |   `-- ultron@1.0.2
  +-- has-binary@0.1.7
  | `-- isarray@0.0.1
  +-- socket.io-adapter@0.4.0
  | `-- socket.io-parser@2.2.2
  |   +-- debug@0.7.4
  |   `-- json3@3.2.6
  +-- socket.io-client@1.4.8
  | +-- backo2@1.0.2
  | +-- component-bind@1.0.0
  | +-- component-emitter@1.2.0
  | +-- engine.io-client@1.6.11
  | | +-- component-inherit@0.0.3
  | | +-- has-cors@1.1.0
  | | +-- parsejson@0.0.1
  | | +-- parseqs@0.0.2
  | | +-- ws@1.0.1
  | | +-- xmlhttprequest-ssl@1.5.1
  | | `-- yeast@0.1.2
  | +-- indexof@0.0.1
  | +-- object-component@0.0.3
  | +-- parseuri@0.0.4
  | | `-- better-assert@1.0.2
  | |   `-- callsite@1.0.0
  | `-- to-array@0.1.4
  `-- socket.io-parser@2.2.6
    +-- benchmark@1.0.0
    +-- component-emitter@1.1.2
    `-- json3@3.3.2

npm WARN enoent ENOENT: no such file or directory, open 'E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer\Server\package.json'
npm WARN Server No description
npm WARN Server No repository field.
npm WARN Server No README data
npm WARN Server No license field.
</code></pre>

<h4>
<a id="4-atom으로-프로젝트-폴더-열기" class="anchor" href="#4-atom%EC%9C%BC%EB%A1%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%8F%B4%EB%8D%94-%EC%97%B4%EA%B8%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. Atom으로 프로젝트 폴더 열기</h4>

<pre><code>E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer\Server&gt;cd ..
E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer&gt;atom .
</code></pre>

<p><img src="https://github.com/co2meal/unity-multiplayer/raw/master/2.4%20-%20Atom%EC%9C%BC%EB%A1%9C%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%8F%B4%EB%8D%94%20%EC%97%B4%EA%B8%B0.PNG" alt=""></p>

<h4>
<a id="5-server-폴더에-appjs-파일-생성" class="anchor" href="#5-server-%ED%8F%B4%EB%8D%94%EC%97%90-appjs-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>5. Server 폴더에 app.js 파일 생성</h4>

<p><img src="https://github.com/co2meal/unity-multiplayer/raw/master/2.5%20-%20Atom%EC%97%90%EC%84%9C%20app.js%20%EB%A7%8C%EB%93%A4%EA%B8%B0.PNG" alt=""></p>

<h4>
<a id="6-아주-단순한-서버-코드-복붙하기" class="anchor" href="#6-%EC%95%84%EC%A3%BC-%EB%8B%A8%EC%88%9C%ED%95%9C-%EC%84%9C%EB%B2%84-%EC%BD%94%EB%93%9C-%EB%B3%B5%EB%B6%99%ED%95%98%EA%B8%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6. 아주 단순한 서버 코드 복붙하기</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> io <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>socket.io<span class="pl-pds">'</span></span>)(<span class="pl-c1">80</span>)

<span class="pl-smi">io</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">socket</span>){
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>a user connected<span class="pl-pds">'</span></span>)

  <span class="pl-smi">socket</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>disconnect<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>user disconnect<span class="pl-pds">'</span></span>)
  })
})
</pre></div>

<h4>
<a id="7-서버-코드-실행-및-보안-허용" class="anchor" href="#7-%EC%84%9C%EB%B2%84-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89-%EB%B0%8F-%EB%B3%B4%EC%95%88-%ED%97%88%EC%9A%A9" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7. 서버 코드 실행 및 보안 허용</h4>

<pre><code>E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer\Server&gt;node app.js
</code></pre>

<p><img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/2.7%20-%20%EB%B3%B4%EC%95%88%EA%B2%BD%EA%B3%A0%20%EC%95%A1%EC%84%B8%EC%8A%A4%20%ED%97%88%EC%9A%A9.PNG" alt=""></p>

<h3>
<a id="socket-io-클라이언트" class="anchor" href="#socket-io-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Socket IO 클라이언트</h3>

<ol>
<li><p>SocketIO 애셋 다운로드
<img src="https://github.com/co2meal/unity-multiplayer/raw/master/3.1%20-%20Unity%20Asset%20Store%EC%97%90%EC%84%9C%20Socket.IO%20for%20Unity%20%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C.PNG" alt=""></p></li>
<li><p>Project - Assets-SocketIO-Prefabs 에 있는 SocketIO Scene에 복사
<img src="https://github.com/co2meal/unity-multiplayer/raw/master/3.2%20-%20Project%20-%20Assets-SocketIO-Prefabs%20%EC%97%90%20%EC%9E%88%EB%8A%94%20SocketIO%20Scene%EC%97%90%20%EB%B3%B5%EC%82%AC.PNG" alt=""></p></li>
<li><p>SocketIO Prefab의 Inspector에서 URL을 수정
<img src="https://github.com/co2meal/unity-multiplayer/raw/master/3.3%20-%20SocketIO%20Prefab%EC%9D%98%20Inspector%EC%97%90%EC%84%9C%20URL%EC%9D%84%20%EC%88%98%EC%A0%95.PNG" alt=""></p></li>
<li><p>실행 및 유저가 접속하고 나가는 것을 서버에서 확인.</p></li>
</ol>

<pre><code>E:\Users\ㅁㅁㅁ\Documents\Unity-Multiplayer\Server&gt;node app.js
a user connected
user disconnect
</code></pre>

<h3>
<a id="위치-동기화" class="anchor" href="#%EC%9C%84%EC%B9%98-%EB%8F%99%EA%B8%B0%ED%99%94" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>위치 동기화</h3>

<h4>
<a id="appjs-수정-step-by-step-설명-필요하지만-일단-넘어가기" class="anchor" href="#appjs-%EC%88%98%EC%A0%95-step-by-step-%EC%84%A4%EB%AA%85-%ED%95%84%EC%9A%94%ED%95%98%EC%A7%80%EB%A7%8C-%EC%9D%BC%EB%8B%A8-%EB%84%98%EC%96%B4%EA%B0%80%EA%B8%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>App.js 수정 (step by step 설명 필요하지만 일단 넘어가기)</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-c">/*</span>
<span class="pl-c">  Server version 2</span>
<span class="pl-c">  It supports syncing players.</span>
<span class="pl-c">*/</span>
<span class="pl-k">var</span> io <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>socket.io<span class="pl-pds">'</span></span>)(<span class="pl-c1">80</span>)

<span class="pl-k">var</span> players <span class="pl-k">=</span> {}

<span class="pl-smi">io</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">socket</span>){
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>a user connected<span class="pl-pds">'</span></span>)

  <span class="pl-smi">socket</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>disconnect<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>user disconnect<span class="pl-pds">'</span></span>)
    <span class="pl-k">if</span> (<span class="pl-smi">socket</span>.<span class="pl-c1">id</span> <span class="pl-k">in</span> players) <span class="pl-k">delete</span> players[<span class="pl-smi">socket</span>.<span class="pl-c1">id</span>]
  })

  <span class="pl-smi">socket</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>sync<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">player</span>) {
    <span class="pl-c">/*</span>
<span class="pl-c">      player:</span>
<span class="pl-c">        id: String, but empty</span>
<span class="pl-c">        position: [float, float, float]</span>
<span class="pl-c">        rotation: [float, float, float]</span>
<span class="pl-c">    */</span>
    <span class="pl-smi">player</span>.<span class="pl-c1">id</span> <span class="pl-k">=</span> <span class="pl-smi">socket</span>.<span class="pl-c1">id</span>

    <span class="pl-c">// update server's player list</span>
    players[<span class="pl-smi">player</span>.<span class="pl-c1">id</span>] <span class="pl-k">=</span> player

    <span class="pl-c">// broadcast to other clients</span>
    <span class="pl-smi">socket</span>.<span class="pl-en">broadcast</span>(<span class="pl-s"><span class="pl-pds">'</span>sync<span class="pl-pds">'</span></span>, player)

    <span class="pl-c">// Print current players for debugging</span>
    <span class="pl-en">printPlayers</span>()
  })
})

<span class="pl-k">function</span> <span class="pl-en">printPlayers</span>() {
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(players)
}
</pre></div>

<h4>
<a id="client-코드-작성" class="anchor" href="#client-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Client 코드 작성</h4>

<h5>
<a id="1-플레이어-게임-오브젝트에-playersyncercs-스크립트-생성하고-다음을-복붙" class="anchor" href="#1-%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4-%EA%B2%8C%EC%9E%84-%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8%EC%97%90-playersyncercs-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%83%9D%EC%84%B1%ED%95%98%EA%B3%A0-%EB%8B%A4%EC%9D%8C%EC%9D%84-%EB%B3%B5%EB%B6%99" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 플레이어 게임 오브젝트에 PlayerSyncer.cs 스크립트 생성하고 다음을 복붙.</h5>

<p><img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/4.2.3%20-%20%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4%20%EA%B2%8C%EC%9E%84%20%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8%EC%97%90%20PlayerSyncer%20%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%20%EC%83%9D%EC%84%B1.PNG" alt=""></p>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">using</span> UnityEngine<span class="pl-k">;</span>
<span class="pl-k">using</span> SocketIO<span class="pl-k">;</span>
<span class="pl-k">using</span> System<span class="pl-k">;</span>
<span class="pl-k">using</span> System.Collections<span class="pl-k">;</span>

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">PlayerSyncer</span> : <span class="pl-k">MonoBehaviour</span> {

    <span class="pl-k">public</span> <span class="pl-k">static</span> SocketIOComponent socket = <span class="pl-c1">null</span>;
    <span class="pl-c">// Use this for initialization</span>
    <span class="pl-k">void</span> <span class="pl-en">Start</span> () {
        GameObject go = GameObject.Find(<span class="pl-s"><span class="pl-pds">"</span>SocketIO<span class="pl-pds">"</span></span>);
        socket = go.GetComponent&lt;SocketIOComponent&gt;();
    }

    <span class="pl-c">// Update is called once per frame</span>
    <span class="pl-k">void</span> <span class="pl-en">Update</span> () {
        PlayerData player_data = <span class="pl-k">new</span> PlayerData(transform);
        socket.Emit(<span class="pl-s"><span class="pl-pds">"</span>sync<span class="pl-pds">"</span></span>, player_data.ToJSONObject());
    }
}

[Serializable]
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">PlayerData</span> {
    <span class="pl-k">public</span> <span class="pl-k">string</span> id = <span class="pl-s"><span class="pl-pds">"</span>undefined<span class="pl-pds">"</span></span>;
    <span class="pl-k">public</span> Vector3 position;
    <span class="pl-k">public</span> Quaternion rotation;

    <span class="pl-k">public</span> <span class="pl-en">PlayerData</span>(<span class="pl-k">Transform</span> <span class="pl-smi">transform</span>) {
        position = transform.position;
        rotation = transform.rotation;
    }

    <span class="pl-k">public</span> JSONObject <span class="pl-en">ToJSONObject</span>() {
        <span class="pl-k">return</span> <span class="pl-k">new</span> JSONObject(JsonUtility.ToJson(<span class="pl-c1">this</span>));
    }
}</pre></div>

<h5>
<a id="2-다른플레이어들-게임오브젝트-생성-및-프리팹-준비" class="anchor" href="#2-%EB%8B%A4%EB%A5%B8%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4%EB%93%A4-%EA%B2%8C%EC%9E%84%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%94%84%EB%A6%AC%ED%8C%B9-%EC%A4%80%EB%B9%84" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 다른플레이어들 게임오브젝트 생성 및 프리팹 준비</h5>

<ol>
<li>Projects -&gt; Create -&gt; Create Empty</li>
<li>"다른플레이어들" 으로 이름 변경</li>
<li>"플레이어"에 우클릭 -&gt; Duplicate</li>
<li>"다른플레이어들"로 이동, "다른플레이어 프리팹"으로 이름 변경</li>
<li>"다른플레이어 프리팹"의 스크립트 모두 삭제</li>
<li>Project/Assets/Materials 밑의 Albedo Material을 "다른플레이어 프리팹"에 적용
<img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/4.2.2%20-%20%EB%8B%A4%EB%A5%B8%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4%20%ED%94%84%EB%A6%AC%ED%8C%B9%20%EC%A4%80%EB%B9%84%201.PNG" alt="">
</li>
<li>Project에서 Assets/Prefabs 폴더 생성 후 "다른플레이어 프리팹" 드래그앤 드롭</li>
<li>다른플레이어들 아래 다른플레이어 프리팹 삭제
<img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/4.2.2%20-%20%EB%8B%A4%EB%A5%B8%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4%20%ED%94%84%EB%A6%AC%ED%8C%B9%20%EC%A4%80%EB%B9%84%202.PNG" alt="">
</li>
</ol>

<h5>
<a id="3-다른플레이어들에-otherplayerssyncercs-스크립트-생성하고-복붙-프리팹-적용" class="anchor" href="#3-%EB%8B%A4%EB%A5%B8%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4%EB%93%A4%EC%97%90-otherplayerssyncercs-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%83%9D%EC%84%B1%ED%95%98%EA%B3%A0-%EB%B3%B5%EB%B6%99-%ED%94%84%EB%A6%AC%ED%8C%B9-%EC%A0%81%EC%9A%A9" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. "다른플레이어들"에 OtherPlayersSyncer.cs 스크립트 생성하고 복붙, 프리팹 적용</h5>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">using</span> UnityEngine<span class="pl-k">;</span>
<span class="pl-k">using</span> SocketIO<span class="pl-k">;</span>
<span class="pl-k">using</span> System.Collections<span class="pl-k">;</span>
<span class="pl-k">using</span> System.Collections.Generic<span class="pl-k">;</span>


<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">OtherPlayersSyncer</span> : <span class="pl-k">MonoBehaviour</span> {
    <span class="pl-k">public</span> GameObject otherPlayerPrefab;
    <span class="pl-k">private</span> <span class="pl-k">static</span> SocketIOComponent socket = <span class="pl-c1">null</span>;
    <span class="pl-k">private</span> Dictionary&lt;<span class="pl-k">string</span>, GameObject&gt; otherPlayersDict = <span class="pl-k">new</span> Dictionary&lt;<span class="pl-k">string</span>, GameObject&gt;();
    <span class="pl-c">// Use this for initialization</span>
    <span class="pl-k">void</span> <span class="pl-en">Start</span> () {
        GameObject go = GameObject.Find(<span class="pl-s"><span class="pl-pds">"</span>SocketIO<span class="pl-pds">"</span></span>);
        socket = go.GetComponent&lt;SocketIOComponent&gt;();

        socket.On(<span class="pl-s"><span class="pl-pds">"</span>sync<span class="pl-pds">"</span></span>, OnSync);
        socket.On(<span class="pl-s"><span class="pl-pds">"</span>remove<span class="pl-pds">"</span></span>, OnRemove);
    }

    GameObject <span class="pl-en">FindOrCreatePlayer</span>(<span class="pl-k">PlayerData</span> <span class="pl-smi">player_data</span>) {
        <span class="pl-k">if</span> (!otherPlayersDict.ContainsKey(player_data.id)) {
            GameObject newPlayer = Instantiate(
                    otherPlayerPrefab,
                    player_data.position,
                    player_data.rotation) <span class="pl-k">as</span> GameObject;
            newPlayer.transform.parent = GameObject.Find(<span class="pl-s"><span class="pl-pds">"</span>다른플레이어들<span class="pl-pds">"</span></span>).transform;

            otherPlayersDict.Add(player_data.id, newPlayer);
        }

        <span class="pl-k">return</span> otherPlayersDict[player_data.id];
    }

    <span class="pl-k">void</span> <span class="pl-en">OnSync</span>(<span class="pl-k">SocketIOEvent</span> <span class="pl-smi">e</span>) {
        PlayerData player_data = <span class="pl-k">new</span> PlayerData(e.data);

        <span class="pl-c">// Create other player object if it does not exist.</span>
        GameObject player = FindOrCreatePlayer(player_data);
        player.transform.position = player_data.position;
        player.transform.rotation = player_data.rotation;
    }

    <span class="pl-k">void</span> <span class="pl-en">OnRemove</span>(<span class="pl-k">SocketIOEvent</span> <span class="pl-smi">e</span>) {
        PlayerData player_data = <span class="pl-k">new</span> PlayerData(e.data);
        <span class="pl-k">if</span> (otherPlayersDict.ContainsKey(player_data.id)) {
            Destroy(otherPlayersDict[player_data.id]);
            otherPlayersDict.Remove(player_data.id);
        }
    }
}</pre></div>

<p><img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/4.3%20-%20%EB%8B%A4%EB%A5%B8%ED%94%8C%EB%A0%88%EC%9D%B4%EC%96%B4%EB%93%A4%EC%97%90%20OtherPlayerSyncer.cs%20%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%20%EC%83%9D%EC%84%B1%ED%95%98%EA%B3%A0%20%EB%B3%B5%EB%B6%99%20%ED%94%84%EB%A6%AC%ED%8C%B9%20%EC%A0%81%EC%9A%A9.PNG" alt=""></p>

<h5>
<a id="4-build--run" class="anchor" href="#4-build--run" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. Build &amp; Run</h5>

<ol>
<li>File-Bulid Setting-Player Settings...-Run In Background 체크
<img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/4.4%20-%20Run%20In%20Background%20%EC%B2%B4%ED%81%AC%ED%95%98%EA%B8%B0.PNG" alt="">
</li>
<li>Fild-Build Run-파일이름 run.exe으로 저장 및 실행
<img src="https://raw.githubusercontent.com/co2meal/unity-multiplayer/master/4.4.2%20-%20%EC%98%A8%EB%9D%BC%EC%9D%B8%20%EC%84%B1%EA%B3%B5.PNG" alt="">
</li>
</ol>

<h3>
<a id="마무리" class="anchor" href="#%EB%A7%88%EB%AC%B4%EB%A6%AC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>마무리</h3>

<p>이상으로 멀티플레이어 당구공 만들었음<br>
숙제로 <code>Transform</code>의 <code>position</code>, <code>rotation</code>만 보낼 것이 아니라 <code>Rigidbody</code>의 <code>position</code>, <code>rotation</code>, <code>velocity</code> 를 동기화하는 걸 구현해 보시길.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
